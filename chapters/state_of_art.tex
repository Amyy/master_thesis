\chapter{Related Work}
\label{cha:stateOfTheArt}

In this chapter, state-of-the-art works regarding quantum-secure \textit{hash-based signature systems (HBS)} and their performance improvement are proposed. 
The focus will be on works regarding solely HBS and no other classical digital signature systems (e.g. RSA) as these generally outperform hash-based signature systems (performance, signature/key size), but do not fulfill the requirement to be quantum secure~\cite{RSA_pq-attack_examples_2018,comparison_performance_RSA_ECDSA_Merkle_WOTS_2021}.
First, the two categories \textit{stateful}- and \textit{stateless} HBS and their corresponding HBS are introduced. Afterwards, current works improving the performance of HBS are proposed.

\section{Stateful HBS} % maybe put part of this stateful explanation in introduction
Most common digital signature systems currently in use are stateless signature systems: The signer has one secret key that is used multiple times for signing. In stateful signature schemes, the secret key is only used once, therefore referred to as one-time key. If the key same key is used more than once, the security will be compromised. 
To achieve this, the signer needs to maintain a state (of the current key) while signing messages (that is updated after every signature). To generate each one-time key, a one-time signature scheme (OTS) is used (e.g. WOTS and WOTS+, explained in detail in Section~\ref{sec:wots_general} and \ref{sec:wots+_general}).
A stateful scheme is less practical than a stateless scheme, as a careful treatment of its one-time key states is required. 
In some situations, managing states is acceptable for meeting other demands: In comparison with other quantum-secure stateless HBS, stateful HBS are more efficient, the signature size is smaller, and there are more signing occasions.~\cite{properties_stateless_HBS_2022}
\\ \\
The most recent stateful HBS are the \textit{Leighton-Micali Signature Scheme (LMS)}~\cite{LMS_RFC8554} and the \textit{eXtended Merkle Signature Scheme (XMSS)}~\cite{xmss_RFC8391}. They are standardized and recommended for usage as quantum-secure HBS by the National Institute of Standards and Technology (NIST)~\cite{stateful_hashbased_sign_schemes_NIST_2020}. Both these signature schemes are explained in detail as a part of this work. For LMS see Section~\ref{sec:lms}, for XMSS see Section~\ref{sec:xmss}.
% lms / xmss paper pic?
\\ \\
An extension of XMSS is \textit{Multi Tree XMSS (XMSS$^{MT}$)}, a hash-based
signature scheme that can be used to sign a larger (but still fixed) number of messages.
XMSS$^{MT}$ uses hyper-tree, a tree of several layers of XMSS trees. The root nodes of the lower layers are signed by the trees on top and intermediate layers. To sign a message, the trees on the lowest layer are used respectively.~\cite{xmss_multitree_2013,xmss_RFC8391}

\section{Stateless HBS}
% is the typical / common signature system
The most common quantum-secure stateless HBS recommended and standardized by NIST is \textit{SPHINCS+}~\cite{tweakable_basispaper_sphincs_2019} (an improvement of SPHINCS~\cite{sphincs_old_version_2015}).
SPHINCS+ uses a few-time signature scheme (FTS) to sign more than one message.
SPHINCS+ replaces the generation of leaves with an OTS (the one-time signature schemes used for generating the leaves in stateful HBS) with a FTS.
The FTS used in SPHINCS is HORS/HORST (HORS with trees), the FTS used in SPHINCS+ is Forest of Random Subsets (FORS). The idea is to authenticate a huge number of few-time keys using a so-called hyper-tree (a tree of trees). The root of the hyper-tree is the public key of the signature system.
~\cite{tweakable_basispaper_sphincs_2019,sphincs+_submission_nist_round2}
% sphincs pic?

\section{Performance Improvements HBS}
In this section, different implementations and performance improvements of the proposed HBS are proposed.
\\ \\
% xmss improvements
% 1
HÃ¼lsing et al.~\cite{xmss+_2018} propose \textit{XMSS+}, a HBS based on XMSS. Compared to XMSS, the key generation time is reduced from $\mathcal{O}(n)$ to $\mathcal{O}(\sqrt{n})$, with $n$ being the number of signatures that can be created with one key pair.
\\ \\
% 2
Bos et al.~\cite{xmss_rapidly_verif_sign_2020} propose a method \textit{Rapidly Verifiable XMSS Signatures} which is speeding up the XMSS signature verification. It is based one the PZMCM technique~\cite{PZMCM_speedup_wots_2018}, which changes the XMSS signing algorithm to find verifiable signatures: In XMSS, the amount of hash calls for generating a signature and afterwards verifying it always sums up to the same value. This \textit{counter value} is added to the input of the message hash, then $T$ different counter values are tried. Afterwards, the counter value leading to the fastest signature is chosen out of the $T$ possibilities.
%The improvement of verification time with this method is shown in Table~\ref{table:fast_ver_xmss_sign}. 

% not sure exactly what values in this table do
%\begin{table}
%\centering
%\begin{tabular}{c l c c} 
% \hline\noalign{\smallskip}
% \multicolumn{4}{c}{\textbf{Rapidly Verifiable XMSS Signatures - Performance Results}} \\
% \# msg. hashes & Signature Gen.& Max. & Min. \\
% \hline\noalign{\smallskip}
%$2^{10}$ & $\sim 0.04$ sec. & $421.64$ $(-16.1\%)$ & $335.66$ $(-33.2\%)$ \\
%$2^{21}$ & $\sim 1$ sec.& $348.77$ $(-30.6\%)$ & $289.84$ $(-42.3\%)$ \\
%$2^{27}$ & $\sim 1$ min. & & \\
%$2^{33}$ & $\sim 1$ hour & & \\
%$2^{37.5}$ & $\sim 1$ day & & \\
%$2^{40.5}$ & $\sim 1$ week & & \\
% \hline
%\end{tabular}
%\caption{Speed up of signature generation time and verification using the method of Bos et al.~\cite{xmss_rapidly_verif_sign_2020} with $2^T$ different counter values (i.e. \# message hashes). Improvement in $\%$ compared to standard XMSS is displayed in brackets.} 
%\label{table:fast_ver_xmss_sign}
%\end{table}

% SPHINCS+ improvements
% armed sphincs+: https://eprint.iacr.org/eprint-bin/getfile.pl?entry=2015/1042&version=20151028:210900&file=1042.pdf


% other variants (maybe introduction):
% picnic -> ZKP scheme?
% Rainbow, GeMMs -> MultiVariate
% crystals-dilithium, falcon -> Lattice
% BPQS = blockchained post quantum signatures -> https://eprint.iacr.org/2018/658.pdf

% maybe add examples/cases where Merkle tree outperforms RSA/ECDSA. -> https://link.springer.com/chapter/10.1007/978-3-540-85893-5_8 , year 2008
% -> or add attacks to RSA to introduction

